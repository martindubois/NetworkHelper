
! Authot    KMS - Martin Dubois, P.Eng.
! Copyright (C) 2020 KMS. All rights reserved.
! Product   NetworkHelper
! File      NHLib_Test/Tests/Test_6_Router_0.txt

! This file test error detection when parsing configuration file.

! >>>>> CONFIG ERROR  -225  "ip address" command outside of an "interface" section
ip address 192.168.0.1 255.255.255.0

! ===== Access ==============================================================

! TEST INFO Access.Error
!           -213, -214, -215, -216, -217, -226, -405

! >>>>> ERROR  -217  Access rule IP 192.168.0.10 ==> 192.168.0.10 - Describes traffic not going through the network
ip access-list extended 101	permit ip host 192.168.0.10 host 192.168.0.10

ip access-list extended 102

	! >>>>> ERROR  -216  Access rule IP 192.168.0.0/255.255.255.0 ==> 192.168.0.10 - Describes traffic not going through the router
	permit ip 192.168.0.0 0.0.0.255 host 192.168.0.10

	! >>>>> ERROR  -215  Access rule IP 192.168.0.10 ==> 192.168.0.0/255.255.255.0 - Describes traffic not going through the router
	permit ip host 192.168.0.10 192.168.0.0 0.0.0.255

exit

! >>>>> CONFIG ERROR  -214  Only the TCP rule can use the "establish" flag
ip access-list extended 103 permit UDP host 192.168.0.10 eq 80 192.168.10.0 0.0.0.255 established

! >>>>> CONFIG ERROR  -213  Invalid port number
ip access-list extended 104 permit UDP any any eq 65537

! >>>>> PARSE ERROR  -405  Invalid IPv4 inverted net mask format
ip access-list extended 105 permit IP 192.168.0.0 Invalid any

! >>>>> CONFIG ERROR  -226  Access end - Invalid IP address
ip access-list extended 106 permit IP any host 240.0.0.1

// ===== DHCP ===============================================================

! TEST INFO DHCP.Error
!           -211, -212, -401

! >>>>> PARSE ERROR  -401  The command "network" must have at least 3 elements
network

ip dhcp pool Alice

	! >>>>> CONFIG ERROR  -212  The subnet address is not a valid subnet address
	network 192.168.0.1 255.255.255.0

ip dhcp pool Bob

	! >>>>> CONFIG ERROR  -211  The subnet address is not valid
	network 0.0.0.1 255.255.255.0

exit

! ===== Interface ===========================================================

! TEST INFO Interface.Error
!           -1, -209 -210, -225, -401, -402, -404

! >>>>> PARSE ERROR  -401  The command "encapsulation dot1q" must have at least 3 elements
encapsulation dot1q

! >>>>> CONFIG ERROR  -225  "encapsulation dot1q" command outside of an "interface" section
encapsulation dot1q 10

! >>>>> PARSE ERROR  -401  The command "interface" must have at least 2 elements
interface

! >>>>> PARSE ERROR  -401  The command "interface tunnel" must have at least 3 elements
interface tunnel

! >>>>> PARSE ERROR  -401  The command "ip address" must have at least 4 elements
ip address

! >>>>> PARSE ERROR  -402  The command "ip address dhcp" must have 3 elements or less
ip address dhcp invalid

interface f0/1

	! >>>>> PARSE ERROR  -404  Invalid IPv4 address format
	ip address Invalid 255.255.255.0

	! >>>>> CONFIG ERROR  -227  Interface - Invalid IPv4 address
	ip address 0.0.0.1 255.255.255.0

interface f0/2

	! >>>>> CONFIG ERROR  -210  Invalid IPv4 address
	ip address 0.0.0.0 255.255.255.0

interface f0/3

	ip access-group 101 in

	! >>>>> CONFIG ERROR  -209  An access list is already set for this direction
	ip access-group 102 in

exit

! ERROR    -1  File NHLib_Test/Tests/Test_6_Router_0.txt - 33 lines with error

! ===== NAT =================================================================

// TEST INFO NAT.Error
//           -203, -204, -402

! >>>>> PARSE ERROR  -402  The command "ip nat outside" must have 3 elements or less
ip nat outside invalid

interface f0/4

	ip nat outside

	! >>>>> CONFIG ERROR  -203  A same interface cannot be NAT outside and NAT inside
	ip nat inside

interface f0/5

	ip nat inside

	! >>>>> CONFIG ERROR  -204  A same interface cannot be NAT inside and NAT outside
	ip nat outside

exit

! ===== Route ===============================================================

! TEST INFO Route.Error
!           -228, -401

! >>>>> PARSE ERROR  -401  The command "ip route" must have at least 5 elements
ip route

! >>>>> CONFIG ERROR  -228  Route - Invalid next router IPv4 address
ip route 192.168.10.0 255.255.255.0 0.0.0.1

! ===== Sub-Interface =======================================================

! TEST INFO Sub-Interface.Error
!           -201, -202, -218, -219, -220, -221, -222, -223, -224, -403 

interface test1

	! >>>>> PARSE ERROR  -403  Invalid VLAN number
	encapsulation dot1q invalid

	! >>>>> CONFIG ERROR  -201  A VLAN number must be below 4096
	encapsulation dot1q 4096

	! >>>>> CONFIG ERROR  -202  A VLAN must be set on sub-interface
	encapsulation dot1q 10

	ip address dhcp

	! >>>>> CONFIG ERROR  -224  Do not configure an IPv4 address on an interace with DHCP client enabled
	ip address 1.2.3.4 255.255.255.0

interface test2

	ip address 1.2.3.4 255.255.255.0

	! >>>>> CONFIG ERROR  -223  Do not enable DHCP client on an interface with a valid IPv4 address
	ip address dhcp

! >>>>> CONFIG ERROR  -222  Do not create sub-interface for an interface with a IPv4 address configured
interface test2.1

interface test3.1

interface test3

	! >>>>> CONFIG ERROR  -221  Do not set a VLAN for an interface with sub-interfaces
	encapsulation dot1q 10

	! >>>>> CONFIG ERROR  -220  Do not configure an IPv4 address on an interface with sub-interfaces
	ip address 1.2.3.4 255.255.255.0

	! >>>>> CONFIG ERROR  -219  Do not enable DHCP client on an interface with sub-interfaces
	ip address dhcp

interface test4

	ip address dhcp

! >>>>> CONFIG ERROR  -218  Do not create sub-interface for an interface with DHCP client enabled
interface test4.1

exit

! ===== Expected error message after parsing the file =======================
! ERROR    -1  File NHLib_Test/Tests/Test_6_Router_0.txt - 36 lines with error
