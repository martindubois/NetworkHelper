
! Authot    KMS - Martin Dubois, P.Eng.
! Copyright (C) 2020 KMS. All rights reserved.
! Product   NetworkHelper
! File      NHLib_Test/Tests/Test_7_Router_0.txt

! This file test error detected when verifying the router configuration by calling NH::Router::Verify.

! TEST INFO AccessList.Error
!           A same access-list describes opposed traffics

ip access-list extended 103
	permit tcp 192.168.10.0 0.0.0.255 192.168.20.0 0.0.0.255
	permit tcp 192.168.20.0 0.0.0.255 host 192.168.10.10 eq 80
	permit udp host 192.168.20.1 192.168.10.0 0.0.0.255 neq 21
exit

! TEST INFO AccessList.Error
!           The access-list is used in the bad direction

ip access-list extended 104	permit tcp host 192.168.10.10 eq 80 192.168.0.0 0.0.0.255 established

interface f0/0
	ip address 192.168.0.1 255.255.255.0
	ip access-group 104 in
exit

ip access-list extended 105 permit udp 192.168.10.0 0.0.0.255 192.168.0.0 0.0.0.255

interface f0/1
	ip address 192.168.10.1 255.255.255.0
	ip access-group 105 out
exit

! TEST INFO DHCP.Error
!           An interface act as DHCP server but the input access-list do not permit DHCP request

ip access-list extended 106
	permit tcp 192.168.30.0 0.0.0.255 any eq 80
	deny udp any any eq 67
exit

interface f0/2
	ip address 192.168.30.1 255.255.255.0
	ip access-group 106 in
exit

ip dhcp pool alice
	network 192.168.30.0 255.255.255.0
exit

! ===== Expected error at verification ======================================
! ERROR   122  In 103 access-list, TCP 192.168.10.0/255.255.255.0 ==> 192.168.20.0/255.255.255.0 and TCP 192.168.20.0/255.255.255.0 ==> 192.168.10.10 == 80 describe opposed trafics
! ERROR   122  In 103 access-list, TCP 192.168.10.0/255.255.255.0 ==> 192.168.20.0/255.255.255.0 and UDP 192.168.20.1 ==> 192.168.10.0/255.255.255.0 != 21 describe opposed trafics
! ERROR   133  access-list 103 - 2 errors (150)
! ERROR   162  In 104 access-list, TCP 192.168.10.10 == 80 ==> 192.168.0.0/255.255.255.0  describe trafic going out from the interace and the access list is using as "in"
! ERROR   185  access-list 104 - 1 errors (312)
! ERROR   333  interface f0/0 - 1 errors (204)
! ERROR   170  In 105 access-list, UDP 192.168.10.0/255.255.255.0 ==> 192.168.0.0/255.255.255.0  describe trafic going in to the interace and the access list is using as "out"
! ERROR   185  access-list 105 - 1 errors (312)
! ERROR   333  interface f0/1 - 1 errors (204)
! CONFIG ERROR   328  Interface f0/2 act as DHCP server but DHCP request are not allowed in
! ERROR   333  interface f0/2 - 1 errors (204)
! ERROR   209  Router's interfaces - 3 errors (160)

! ===== Expected error at the end of processing =============================
! ERROR   202  router Test_7_Router_0 - 2 errors
