
! Authot    KMS - Martin Dubois, P.Eng.
! Copyright (C) 2020 KMS. All rights reserved.
! Product   NetworkHelper
! File      NHLib_Test/Tests/Test_7_Router_0.txt

! This file test error detected when verifying the router configuration by calling NH::Router::Verify.

! TEST INFO AccessList.Error
!           A same access-list describes opposed traffics

ip access-list extended 103
	permit tcp 192.168.10.0 0.0.0.255 192.168.20.0 0.0.0.255
	permit tcp 192.168.20.0 0.0.0.255 host 192.168.10.10 eq 80
	permit udp host 192.168.20.1 192.168.10.0 0.0.0.255 neq 21
exit

! TEST INFO AccessList.Error
!           The access-list is used in the bad direction

ip access-list extended 104	permit tcp host 192.168.10.10 eq 80 192.168.0.0 0.0.0.255 established

interface f0/0
	ip address 192.168.0.1 255.255.255.0
	ip access-group 104 in
exit

ip access-list extended 105 permit udp 192.168.10.0 0.0.0.255 192.168.0.0 0.0.0.255

interface f0/1
	ip address 192.168.10.1 255.255.255.0
	ip access-group 105 out
exit

! TEST INFO DHCP.Error
!           An interface act as DHCP server but the input access-list do not permit DHCP request

ip access-list extended 106
	permit tcp 192.168.30.0 0.0.0.255 any eq 80
	deny udp any any eq 67
exit

interface f0/2
	ip address 192.168.30.1 255.255.255.0
	ip access-group 106 in
exit

ip dhcp pool alice
	network 192.168.30.0 255.255.255.0
exit

! ===== Expected error at verification ======================================
! CONFIG ERROR  -208  Access list 103 - TCP 192.168.10.0/255.255.255.0 ==> 192.168.20.0/255.255.255.0 and TCP 192.168.20.0/255.255.255.0 ==> 192.168.10.10 == 80 describe opposed traffics
! CONFIG ERROR  -208  Access list 103 - TCP 192.168.10.0/255.255.255.0 ==> 192.168.20.0/255.255.255.0 and UDP 192.168.20.1 ==> 192.168.10.0/255.255.255.0 != 21 describe opposed traffics
! ERROR    -6  Access list 103 - 2 errors (150)
! CONFIG ERROR  -207  Access list 104 - TCP 192.168.10.10 == 80 ==> 192.168.0.0/255.255.255.0  describe traffic going out from the interace and the access list is used as "in"
! ERROR    -5  Access list 104 - 1 errors (312)
! ERROR    -4  Interface f0/0 - 1 errors (204)
! CONFIG ERROR  -206  Access list 105, UDP 192.168.10.0/255.255.255.0 ==> 192.168.0.0/255.255.255.0  describe traffic going into the interace and the access list is used as "out"
! ERROR    -5  Access list 105 - 1 errors (312)
! ERROR    -4  Interface f0/1 - 1 errors (204)
! CONFIG ERROR  -205  Interface f0/2 - Act as DHCP server but DHCP request are not allowed in
! ERROR    -4  Interface f0/2 - 1 errors (204)
! ERROR    -3  Router's interfaces - 3 errors (160)
! CONFIG ERROR  -229  Router - IP routing is not enabled and the router use more than one interface

! ===== Expected error at the end of processing =============================
! ERROR    -2  Router Test_7_Router_0 - 3 errors
